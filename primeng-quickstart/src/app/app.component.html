<!-- file: src/app/app.component.html -->
<div style="height:100vh; width:100%; display:flex; flex-direction:column">
  <p-toolbar>
    <ng-template pTemplate="start">
      <div style="display:flex; align-items:center; gap:.5rem">
        <p-select
          inputId="dataSource"
          [options]="dataSources"
          [(ngModel)]="selectedDataSource"
          optionLabel="label"
          optionValue="value"
          styleClass="w-16rem"
          placeholder="Datenquelle auswählen">
        </p-select>
      </div>
    </ng-template>

    <ng-template pTemplate="end">
      <button pButton type="button" icon="pi pi-download" label="Download" class="p-button-outlined"
              style="margin-left:.5rem"></button>
    </ng-template>
  </p-toolbar>

  <p-splitter
    [style]="{ 'flex-grow': 1, 'overflow': 'hidden', width: '100%' }"
    [panelSizes]="[25, 75]"
    [minSizes]="[15, 10]"
    layout="horizontal">

    <!-- Left panel -->
    <ng-template #panel>
      <div
        style="
          height:100%;
          display:flex;
          flex-direction:column;
        "
      >
        <div
          style="
            flex:1 1 0;
            min-height:0;
            display:flex;
          "
        >
          <p-listbox
            [style]="{ width:'100%', border:'none' }"
            [group]="true"
            [options]="groupedOptions"
            optionGroupLabel="label"
            optionGroupChildren="items"
            [(ngModel)]="selectedItem"
            optionLabel="label"
            optionValue="value"
            [filter]="false"
            filterPlaceholder="Suchen…"
            styleClass="left-listbox"
            [listStyle]="{ overflow: 'auto', 'max-height': '100%' }"
          ></p-listbox>
        </div>
      </div>
    </ng-template>

    <!-- Right panel -->
    <ng-template #panel>
      <p-table
        [value]="products"
        size="small"
        dataKey="id"
        [rowTrackBy]="rowTrackBy"
        showGridlines
        [resizableColumns]="true"
        columnResizeMode="expand"
        [paginator]="true"
        paginatorPosition="bottom"
        [rows]="25"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Showing {first}–{last} of {totalRecords}"
        [scrollable]="true"
        scrollHeight="flex"
        [style]="{ flex: '1 1 0' }"
        [tableStyle]="{ 'min-width': '50rem' }"
        sortMode="single">

        <ng-template pTemplate="header">
          <tr>
            <th pResizableColumn pSortableColumn="code" style="width:20%">
              <div style="display:flex;align-items:center;gap:.5rem">
                Code
                <p-sortIcon field="code"></p-sortIcon>
              </div>
            </th>
            <th pResizableColumn pSortableColumn="name" style="width:20%">
              <div style="display:flex;align-items:center;gap:.5rem">
                Name
                <p-sortIcon field="name"></p-sortIcon>
              </div>
            </th>
            <th pResizableColumn pSortableColumn="category" style="width:20%">
              <div style="display:flex;align-items:center;gap:.5rem">
                Category
                <p-sortIcon field="category"></p-sortIcon>
              </div>
            </th>
            <th pResizableColumn pSortableColumn="quantity" style="width:20%; text-align:right">
              <div style="display:flex;align-items:center;gap:.5rem; justify-content:flex-end">
                Quantity
                <p-sortIcon field="quantity"></p-sortIcon>
              </div>
            </th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-product>
          <tr>
            <td>{{ product.code }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.category }}</td>
            <td style="text-align:right; font-variant-numeric: tabular-nums;">
              {{ product.quantity | number:'1.0-0' }}
            </td>
          </tr>
        </ng-template>
      </p-table>
    </ng-template>
  </p-splitter>
</div>
